<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Interactive world map to learn airport codes">
  <title>Airport Code Explorer - Learn Airport Codes</title>
  
  <!-- Leaflet CSS - Load First -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
    crossorigin=""/>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    #map {
      width: 100%;
      height: 100%;
    }
    .leaflet-container {
      font-family: inherit;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <!-- Leaflet JS - Load Before App -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
    crossorigin=""></script>
  
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  
  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Icon components
    const Search = ({ className }) => (
      <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
    );

    const X = ({ className }) => (
      <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    );

    const Plane = ({ className }) => (
      <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z"></path>
      </svg>
    );

    const MapPin = ({ className }) => (
      <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path>
        <circle cx="12" cy="10" r="3"></circle>
      </svg>
    );

    const Layers = ({ className }) => (
      <svg className={className} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
        <polyline points="2 17 12 22 22 17"></polyline>
        <polyline points="2 12 12 17 22 12"></polyline>
      </svg>
    );

    const AirportMap = () => {
      const mapRef = useRef(null);
      const mapInstanceRef = useRef(null);
      const markersRef = useRef([]);
      const [searchTerm, setSearchTerm] = useState('');
      const [selectedAirport, setSelectedAirport] = useState(null);
      const [filter, setFilter] = useState('all');
      const [mapStyle, setMapStyle] = useState('streets');
      const [isMapReady, setIsMapReady] = useState(false);

      const airports = [
        { code: 'ATL', name: 'Hartsfield-Jackson Atlanta', city: 'Atlanta', country: 'USA', lat: 33.6407, lng: -84.4277, region: 'americas' },
        { code: 'LAX', name: 'Los Angeles International', city: 'Los Angeles', country: 'USA', lat: 33.9416, lng: -118.4085, region: 'americas' },
        { code: 'ORD', name: "O'Hare International", city: 'Chicago', country: 'USA', lat: 41.9742, lng: -87.9073, region: 'americas' },
        { code: 'DFW', name: 'Dallas/Fort Worth', city: 'Dallas', country: 'USA', lat: 32.8998, lng: -97.0403, region: 'americas' },
        { code: 'DEN', name: 'Denver International', city: 'Denver', country: 'USA', lat: 39.8561, lng: -104.6737, region: 'americas' },
        { code: 'JFK', name: 'John F. Kennedy International', city: 'New York', country: 'USA', lat: 40.6413, lng: -73.7781, region: 'americas' },
        { code: 'SFO', name: 'San Francisco International', city: 'San Francisco', country: 'USA', lat: 37.6213, lng: -122.3790, region: 'americas' },
        { code: 'LAS', name: 'Harry Reid International', city: 'Las Vegas', country: 'USA', lat: 36.0840, lng: -115.1537, region: 'americas' },
        { code: 'SEA', name: 'Seattle-Tacoma International', city: 'Seattle', country: 'USA', lat: 47.4502, lng: -122.3088, region: 'americas' },
        { code: 'MCO', name: 'Orlando International', city: 'Orlando', country: 'USA', lat: 28.4312, lng: -81.3081, region: 'americas' },
        { code: 'MIA', name: 'Miami International', city: 'Miami', country: 'USA', lat: 25.7959, lng: -80.2870, region: 'americas' },
        { code: 'YYZ', name: 'Toronto Pearson', city: 'Toronto', country: 'Canada', lat: 43.6777, lng: -79.6248, region: 'americas' },
        { code: 'MEX', name: 'Mexico City International', city: 'Mexico City', country: 'Mexico', lat: 19.4363, lng: -99.0721, region: 'americas' },
        { code: 'GRU', name: 'SÃ£o Paulo-Guarulhos', city: 'SÃ£o Paulo', country: 'Brazil', lat: -23.4356, lng: -46.4731, region: 'americas' },
        { code: 'LHR', name: 'London Heathrow', city: 'London', country: 'UK', lat: 51.4700, lng: -0.4543, region: 'europe' },
        { code: 'CDG', name: 'Charles de Gaulle', city: 'Paris', country: 'France', lat: 49.0097, lng: 2.5479, region: 'europe' },
        { code: 'AMS', name: 'Amsterdam Schiphol', city: 'Amsterdam', country: 'Netherlands', lat: 52.3105, lng: 4.7683, region: 'europe' },
        { code: 'FRA', name: 'Frankfurt Airport', city: 'Frankfurt', country: 'Germany', lat: 50.0379, lng: 8.5622, region: 'europe' },
        { code: 'MAD', name: 'Madrid-Barajas', city: 'Madrid', country: 'Spain', lat: 40.4983, lng: -3.5676, region: 'europe' },
        { code: 'BCN', name: 'Barcelona-El Prat', city: 'Barcelona', country: 'Spain', lat: 41.2974, lng: 2.0833, region: 'europe' },
        { code: 'IST', name: 'Istanbul Airport', city: 'Istanbul', country: 'Turkey', lat: 41.2753, lng: 28.7519, region: 'europe' },
        { code: 'MUC', name: 'Munich Airport', city: 'Munich', country: 'Germany', lat: 48.3538, lng: 11.7750, region: 'europe' },
        { code: 'FCO', name: 'Rome Fiumicino', city: 'Rome', country: 'Italy', lat: 41.8003, lng: 12.2389, region: 'europe' },
        { code: 'DXB', name: 'Dubai International', city: 'Dubai', country: 'UAE', lat: 25.2532, lng: 55.3657, region: 'asia' },
        { code: 'DOH', name: 'Hamad International', city: 'Doha', country: 'Qatar', lat: 25.2731, lng: 51.6080, region: 'asia' },
        { code: 'HND', name: 'Tokyo Haneda', city: 'Tokyo', country: 'Japan', lat: 35.5494, lng: 139.7798, region: 'asia' },
        { code: 'NRT', name: 'Narita International', city: 'Tokyo', country: 'Japan', lat: 35.7720, lng: 140.3929, region: 'asia' },
        { code: 'PEK', name: 'Beijing Capital', city: 'Beijing', country: 'China', lat: 40.0799, lng: 116.6031, region: 'asia' },
        { code: 'PVG', name: 'Shanghai Pudong', city: 'Shanghai', country: 'China', lat: 31.1443, lng: 121.8083, region: 'asia' },
        { code: 'ICN', name: 'Incheon International', city: 'Seoul', country: 'South Korea', lat: 37.4602, lng: 126.4407, region: 'asia' },
        { code: 'SIN', name: 'Singapore Changi', city: 'Singapore', country: 'Singapore', lat: 1.3644, lng: 103.9915, region: 'asia' },
        { code: 'HKG', name: 'Hong Kong International', city: 'Hong Kong', country: 'China', lat: 22.3080, lng: 113.9185, region: 'asia' },
        { code: 'BKK', name: 'Suvarnabhumi', city: 'Bangkok', country: 'Thailand', lat: 13.6900, lng: 100.7501, region: 'asia' },
        { code: 'DEL', name: 'Indira Gandhi International', city: 'New Delhi', country: 'India', lat: 28.5562, lng: 77.1000, region: 'asia' },
        { code: 'BOM', name: 'Chhatrapati Shivaji', city: 'Mumbai', country: 'India', lat: 19.0896, lng: 72.8656, region: 'asia' },
        { code: 'JNB', name: 'O.R. Tambo International', city: 'Johannesburg', country: 'South Africa', lat: -26.1392, lng: 28.2460, region: 'africa' },
        { code: 'CAI', name: 'Cairo International', city: 'Cairo', country: 'Egypt', lat: 30.1219, lng: 31.4056, region: 'africa' },
        { code: 'CPT', name: 'Cape Town International', city: 'Cape Town', country: 'South Africa', lat: -33.9715, lng: 18.6021, region: 'africa' },
        { code: 'SYD', name: 'Sydney Kingsford Smith', city: 'Sydney', country: 'Australia', lat: -33.9399, lng: 151.1753, region: 'oceania' },
        { code: 'MEL', name: 'Melbourne Airport', city: 'Melbourne', country: 'Australia', lat: -37.6690, lng: 144.8410, region: 'oceania' },
        { code: 'AKL', name: 'Auckland Airport', city: 'Auckland', country: 'New Zealand', lat: -37.0082, lng: 174.7850, region: 'oceania' },
      ];

      const filteredAirports = airports.filter(airport => {
        const matchesSearch = 
          airport.code.toLowerCase().includes(searchTerm.toLowerCase()) ||
          airport.city.toLowerCase().includes(searchTerm.toLowerCase()) ||
          airport.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
          airport.country.toLowerCase().includes(searchTerm.toLowerCase());
        
        const matchesRegion = filter === 'all' || airport.region === filter;
        
        return matchesSearch && matchesRegion;
      });

      const getRegionColor = (region) => {
        const colors = {
          americas: '#f97316',
          europe: '#10b981',
          asia: '#ec4899',
          africa: '#eab308',
          oceania: '#8b5cf6'
        };
        return colors[region] || '#3b82f6';
      };

      useEffect(() => {
        if (typeof L !== 'undefined') {
          setIsMapReady(true);
        }
      }, []);

      useEffect(() => {
        if (!isMapReady || !mapRef.current || mapInstanceRef.current) return;

        const map = L.map(mapRef.current, {
          center: [20, 0],
          zoom: 2,
          minZoom: 2,
          maxZoom: 18,
          worldCopyJump: true
        });

        mapInstanceRef.current = map;

        const tileLayers = {
          streets: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap',
            maxZoom: 19
          }),
          dark: L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: 'Â© OpenStreetMap Â© CartoDB',
            maxZoom: 19
          }),
          satellite: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles Â© Esri',
            maxZoom: 19
          })
        };

        tileLayers[mapStyle].addTo(map);

        return () => {
          if (mapInstanceRef.current) {
            mapInstanceRef.current.remove();
            mapInstanceRef.current = null;
          }
        };
      }, [isMapReady, mapStyle]);

      useEffect(() => {
        if (!mapInstanceRef.current || typeof L === 'undefined') return;

        const map = mapInstanceRef.current;

        markersRef.current.forEach(marker => marker.remove());
        markersRef.current = [];

        filteredAirports.forEach(airport => {
          const color = getRegionColor(airport.region);
          
          const iconHtml = `
            <div style="position: relative; width: 30px; height: 30px;">
              <div style="
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 20px;
                height: 20px;
                background: ${color};
                border: 3px solid white;
                border-radius: 50%;
                box-shadow: 0 2px 8px rgba(0,0,0,0.3);
                display: flex;
                align-items: center;
                justify-content: center;
              ">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="white">
                  <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
                </svg>
              </div>
            </div>
          `;

          const icon = L.divIcon({
            html: iconHtml,
            className: '',
            iconSize: [30, 30],
            iconAnchor: [15, 15]
          });

          const marker = L.marker([airport.lat, airport.lng], { icon })
            .addTo(map)
            .on('click', () => setSelectedAirport(airport))
            .bindTooltip(`<strong>${airport.code}</strong><br/>${airport.city}`, {
              direction: 'top',
              offset: [0, -15]
            });

          markersRef.current.push(marker);
        });

        if (selectedAirport) {
          filteredAirports.forEach(airport => {
            if (airport.code !== selectedAirport.code) {
              const line = L.polyline(
                [[selectedAirport.lat, selectedAirport.lng], [airport.lat, airport.lng]],
                {
                  color: getRegionColor(selectedAirport.region),
                  weight: 2,
                  opacity: 0.4,
                  dashArray: '5, 10'
                }
              ).addTo(map);
              markersRef.current.push(line);
            }
          });
        }
      }, [filteredAirports, selectedAirport, isMapReady]);

      if (!isMapReady) {
        return (
          <div className="w-full h-screen bg-slate-900 flex items-center justify-center">
            <div className="text-center">
              <Plane className="w-16 h-16 text-blue-400 mx-auto mb-4 animate-bounce" />
              <p className="text-white text-xl">Loading Map...</p>
            </div>
          </div>
        );
      }

      return (
        <div className="w-full h-screen bg-slate-900 flex flex-col">
          <div className="bg-slate-800 bg-opacity-95 backdrop-blur-sm border-b border-slate-700 p-4 z-10">
            <div className="max-w-7xl mx-auto">
              <div className="flex items-center justify-between mb-4">
                <div className="flex items-center gap-3">
                  <Plane className="w-8 h-8 text-blue-400" />
                  <h1 className="text-2xl sm:text-3xl font-bold text-white">Airport Code Explorer</h1>
                </div>
                <button
                  onClick={() => setMapStyle(s => s === 'streets' ? 'dark' : s === 'dark' ? 'satellite' : 'streets')}
                  className="flex items-center gap-2 px-3 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors text-sm"
                >
                  <Layers className="w-4 h-4" />
                  <span className="hidden sm:inline">
                    {mapStyle === 'streets' ? 'Street' : mapStyle === 'dark' ? 'Dark' : 'Satellite'}
                  </span>
                </button>
              </div>
              
              <div className="flex flex-col sm:flex-row gap-3">
                <div className="relative flex-1">
                  <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400" />
                  <input
                    type="text"
                    placeholder="Search by code, city, or country..."
                    value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                    className="w-full pl-10 pr-4 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:border-blue-400 focus:outline-none"
                  />
                </div>
                
                <select
                  value={filter}
                  onChange={(e) => setFilter(e.target.value)}
                  className="px-4 py-2 bg-slate-700 text-white rounded-lg border border-slate-600 focus:border-blue-400 focus:outline-none"
                >
                  <option value="all">All Regions</option>
                  <option value="americas">ðŸŸ  Americas</option>
                  <option value="europe">ðŸŸ¢ Europe</option>
                  <option value="asia">ðŸ©· Asia</option>
                  <option value="africa">ðŸŸ¡ Africa</option>
                  <option value="oceania">ðŸŸ£ Oceania</option>
                </select>
              </div>
            </div>
          </div>

          <div className="flex-1 relative">
            <div ref={mapRef} className="w-full h-full" id="map" />

            {selectedAirport && (
              <div
                className="absolute top-4 right-4 bg-slate-800 bg-opacity-95 backdrop-blur-sm rounded-lg shadow-2xl p-6 max-w-sm border-2 z-10"
                style={{ borderColor: getRegionColor(selectedAirport.region) }}
              >
                <button
                  onClick={() => setSelectedAirport(null)}
                  className="absolute top-3 right-3 text-slate-400 hover:text-white transition-colors"
                >
                  <X className="w-5 h-5" />
                </button>
                
                <div className="flex items-start gap-3 mb-4">
                  <div
                    className="rounded-lg p-3"
                    style={{ backgroundColor: getRegionColor(selectedAirport.region) }}
                  >
                    <MapPin className="w-6 h-6 text-white" />
                  </div>
                  <div>
                    <h2
                      className="text-3xl font-bold"
                      style={{ color: getRegionColor(selectedAirport.region) }}
                    >
                      {selectedAirport.code}
                    </h2>
                    <p className="text-sm text-slate-400">Airport Code</p>
                  </div>
                </div>
                
                <div className="space-y-3">
                  <div>
                    <p className="text-sm text-slate-400 mb-1">Airport Name</p>
                    <p className="text-white font-medium">{selectedAirport.name}</p>
                  </div>
                  
                  <div className="grid grid-cols-2 gap-3">
                    <div>
                      <p className="text-sm text-slate-400 mb-1">City</p>
                      <p className="text-white">{selectedAirport.city}</p>
                    </div>
                    <div>
                      <p className="text-sm text-slate-400 mb-1">Country</p>
                      <p className="text-white">{selectedAirport.country}</p>
                    </div>
                  </div>
                  
                  <div className="pt-3 border-t border-slate-700">
                    <p className="text-xs text-slate-400 italic">
                      Click another airport to see connections!
                    </p>
                  </div>
                </div>
              </div>
            )}

            <div className="absolute bottom-4 left-4 bg-slate-800 bg-opacity-95 backdrop-blur-sm rounded-lg p-4 border border-slate-700 z-10">
              <p className="text-white text-sm font-bold mb-2">
                {filteredAirports.length} of {airports.length} airports
              </p>
              <div className="space-y-1 text-xs">
                {['americas', 'europe', 'asia', 'africa', 'oceania'].map(region => (
                  <div key={region} className="flex items-center gap-2">
                    <div
                      className="w-3 h-3 rounded-full"
                      style={{ backgroundColor: getRegionColor(region) }}
                    />
                    <span className="text-slate-300 capitalize">{region}</span>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<AirportMap />);
  </script>
</body>
</html>
